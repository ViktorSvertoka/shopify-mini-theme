{{ 'collection-carousel.css' | asset_url | stylesheet_tag }}
<script src='{{ 'collection-carousel.js' | asset_url }}' defer></script>

<section class='collection-carousel page-width' id='CollectionCarousel'>
  <div class='collection-carousel__container container'>
    <h2 class='collection-carousel__title'>
      {{ section.settings.heading | default: 'Collection Carousel' }}
    </h2>
  </div>

  {%- assign collection = collections[section.settings.collection] -%}
  {%- if collection and collection.products_count > 0 -%}
    <div class='collection-carousel__wrapper'>
      <div class='collection-carousel__swiper swiper'>
        <ul class='collection-carousel__list swiper-wrapper'>
          {%- for product in collection.products
            limit: section.settings.products_limit
          -%}
            <li class='collection-carousel__item swiper-slide'>
              <div class='collection-carousel__card'>
                <a href='{{ product.url }}' class='collection-carousel__link'>
                  {%- if product.featured_image -%}
                    <img
                      class='collection-carousel__image'
                      src='{{ product.featured_image | image_url: width: 600 }}'
                      alt='{{ product.featured_image.alt | escape }}'
                      loading='lazy'
                    >
                  {%- endif -%}
                </a>
                <p class='collection-carousel__name'>{{ product.title }}</p>
                <span class='collection-carousel__price'>
                  {{ product.price | money }}
                </span>
              </div>
            </li>
          {%- endfor -%}
        </ul>
      </div>

      <button
        class='collection-carousel__button collection-carousel__button--prev'
        type='button'
        aria-label='Previous slide'
      >
        <svg class='collection-carousel__icon'>
          <use href="{{ 'icon-arrow-left.svg' | asset_url }}"></use>
        </svg>
      </button>

      <button
        class='collection-carousel__button collection-carousel__button--next'
        type='button'
        aria-label='Next slide'
      >
        <svg class='collection-carousel__icon'>
          <use href="{{ 'icon-arrow-right.svg' | asset_url }}"></use>
        </svg>
      </button>
    </div>
  {%- else -%}
    <p class='text-center py-8 opacity-60'>
      No products found in this collection.
    </p>
  {%- endif -%}
</section>

{% schema %}
{
  "name": "Collection Carousel",
  "settings": [
    {
      "type": "text",
      "id": "heading",
      "label": "Heading",
      "default": "Collection Carousel"
    },
    {
      "type": "collection",
      "id": "collection",
      "label": "Select collection"
    },
    {
      "type": "range",
      "id": "products_limit",
      "label": "Products to show",
      "min": 3,
      "max": 12,
      "step": 1,
      "default": 5
    }
  ],
  "presets": [
    {
      "name": "Collection Carousel",
      "category": "Product"
    }
  ]
}
{% endschema %}
